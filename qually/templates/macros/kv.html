{% macro kv(thing, section) %}

{% if g.user.has_seat and thing._status <= section %}

<div>
  {% for key in thing._layout[section] %}
  <div class="d-lg-flex">
    <div class="title w-lg-25">
      <label class="mt-1">{{ key }}</label>
    </div>
    <div class="body w-lg-100 d-flex on-hover vis-toggle-{{ data[key] }}-{{ loop.index0 }}">
      <div>
        <p id="display-value-{{ data[key] }}-{{ loop.index0 }}">{{ thing.__dict__.get(data[key]) }}</p>
      </div>
      <div class="ms-auto on-hover-show toggle-target-class" data-toggle-target="vis-toggle-{{ data[key] }}-{{ loop.index0 }}">
        <i class="fas fa-pen fa-fw"></i>
      </div>
    </div>
    <div class="body w-lg-100 d-flex on-hover vis-toggle-{{ data[key] }}-{{ loop.index0 }} d-none">
      <form id="form-update-{{ data[key] }}-{{ loop.index0 }}" action="{{ thing.permalink }}" method="post" class="toasted">
        <input type="hidden" name="csrf_token" value="{{ g.user.csrf_token }}">
        <input id="input-update-{{ data[key] }}-{{ loop.index0 }}"type="text" name="{{ data[key] }}" value="{{ thing.__dict__.get(data[key]) }}">
      </form>
      <a href="javascript:void(0)" class="btn btn-secondary toggle-target-class ms-auto mb-auto" data-toggle-target="vis-toggle-{{ data[key] }}-{{ loop.index0 }}">Cancel</a>
      <a href="javascript:void(0)" class="btn btn-primary toggle-target-class toast-form-submit ms-2 mb-auto update-text" data-toggle-target="vis-toggle-{{ data[key] }}-{{ loop.index0 }}" data-form="form-update-{{ data[key] }}-{{ loop.index0 }}" data-copy-from="input-update-{{ data[key] }}-{{ loop.index0 }}" data-copy-to="display-value-{{ data[key] }}-{{ loop.index0 }}">Save</a>
    </div>
  </div>
  {% endfor %}
</div>

{% else %}

<div>
  {% for key in data %}
  <div class="d-lg-flex">
    <div class="title w-lg-25">
      <label class="mt-1">{{ key }}</label>
    </div>
    <div class="body w-lg-100">
      <p>{{ thing.__dict__.get(data[key]) }}</p>
    </div>
  </div>
  {% endfor %}
</div>

{% endif %}

{% endmacro %}