{% extends "settings/core.html" %}
{% import "macros/kv.html" as kv %}

{% block content %}
<h2 class="h5 mt-3">{{ _("Branding") }}</h2>
<div class="settings-section rounded">

  <div class="d-lg-flex">

    <div class="title w-lg-25">
      <label for="org_name">{{ _("Organization Name") }}</label>
    </div>

    <div class="body w-lg-100">
      <div class="input-group d-flex">

        <form id="form-org-name" action="/settings/organization" method="post" class="w-100 toasted">
          <input type="hidden" name="csrf_token" value="{{ g.user.csrf_token }}">
          <input id="org_name" type="text" name="org_name" class="form-control w-100" value="{{ g.user.organization.name }}">
        </form>
        <a href="javascript:void(0)" class="btn ms-auto toast-form-submit btn-primary rounded" data-form="form-org-name">{{ _("Change Organization Name") }}</a>
        
      </div>
    </div>
  </div>
  <div class="d-lg-flex">

    <div class="title w-lg-25">
      <label for="org_color">{{ _("Color") }}</label>
    </div>

    <div class="body w-lg-100">
      <div class="input-group d-flex">

        <form id="form-org-color" action="/settings/organization" method="post" class="w-100 toasted">
          <input type="hidden" name="csrf_token" value="{{ g.user.csrf_token }}">
          <input id="org_color" type="text" name="color" class="form-control w-100" value="{{ g.user.organization.color }}">
        </form>
        <a href="javascript:void(0)" class="btn ms-auto toast-form-submit btn-primary rounded" data-form="form-org-color">{{ _("Change Organization Color") }}</a>
        
      </div>
    </div>
  </div>
</div>

<h2 class="h5 mt-3">{{ _("Security") }}</h2>
<div class="settings-section rounded">

  <div class="d-lg-flex">

    <div class="title w-lg-25">
      <label for="require-2fa">{{ _("Require two-factor authentication") }}</label>
    </div>

    <div class="body w-lg-100">
      <div class="input-group d-flex">

        <div class="form-check form-switch">
          <input type="checkbox" class="form-check-input check-toast" data-post-url="/settings/organization/toggle_otp" id="require-2fa" {% if g.user.organization.requires_otp %}checked {% endif %}>
          <label class="form-check-label" for="require-2fa"></label>
        </div>

        <div class="text-small">
          <p>{{ _("If enabled, all users will be required to configure two-factor authentication.") }}</p>
        </div>

      </div>
    </div>
  </div>
</div>

<h2 class="h5 mt-3">{{ _("Localization") }}</h2>
<div class="settings-section rounded">

  <div class="d-lg-flex">

    <div class="title w-lg-25">
      <label for="require-2fa">{{ _("Default Language") }}</label>
    </div>

    <div class="body w-lg-100">
      <div class="input-group d-flex">

        <form id="form-org-lang" action="/settings/organization" method="post">
          <input type="hidden" name="csrf_token" value="{{ g.user.csrf_token }}">
          <select class="form-select toast-form-change-submit" name="lang" data-form="form-org-lang">
            {% for l in (0|lang) %}
            <option value="{{ l | lang }}" {% if (l|lang)==g.user.organization.lang %}selected{% endif %}>{{ l }}</option>
            {% endfor %}
          </select>
        </form>
        <p class="text-small">{{ _("Sets the language for new users, record number prefixes, and audit logs.") }}

      </div>
    </div>
  </div>

  <div class="d-lg-flex">

    <div class="title w-lg-25">
      <label for="require-2fa">{{ _("Default Time Zone") }}</label>
    </div>

    <div class="body w-lg-100">
      <div class="input-group d-flex">

        <form id="form-org-tz" action="/settings/organization" method="post">
          <input type="hidden" name="csrf_token" value="{{ g.user.csrf_token }}">
          <select class="form-select toast-form-change-submit" name="tz" data-form="form-org-tz">
            {% for tz in (0|tz) %}
            <option value="{{ tz }}" {% if tz==g.user.organization.tz %}selected{% endif %}>{{ tz }}</option>
            {% endfor %}
          </select>
        </form>
        <p class="text-small">{{ _("Sets the default time zone for new users.") }}

      </div>
    </div>
  </div>
</div>


{% for stage in (record._layout().keys() | sort) %}
{% if not g.user.organization._lifecycle[stage].get('hide_title', False) %}
{% if g.user.organization._lifecycle[stage].get('title_link') %}
<h3 class="h4 text-primary {% if loop.index0 %}mt-3{% endif %}"><a href="{{ g.user.organization._lifecycle[stage]['title_link'] }}">{{ g.user.organization._lifecycle[stage].get('title_text', g.user.organization._lifecycle[stage]['name']) }}</a></h3>
{% else %}
<h3 class="h4 text-primary {% if loop.index0 %}mt-3{% endif %}">{{ g.user.organization._lifecycle[stage].get('title_text', g.user.organization._lifecycle[stage]['name']) }}</h3>
{% endif %}
{% endif %}
{{ kv.kv(g.user.organization, stage, action="/settings/organization) }}
{% endfor %}

{% endblock %}



