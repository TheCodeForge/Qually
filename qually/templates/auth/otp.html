{% extends "auth/sign_in.html" %}

{% block title %}Two-Factor Authentication | {{ 'SITE_NAME' | app_config }}{% endblock %}

{% block content %}
<div id="login-form" class="">

  <h1 class="h2">Sign In</h1>

  <form id="form-login" action="/sign_in" method="post" class="mt-md-3">

    <input type="hidden" name="csrf_token" value="{{ g.time | csrf_token }}"> 
    <input type="hidden" name="time" value="{{ g.time }}">
    <input type="hidden" name="redirect" value="{{ request.values.get('redirect','') | urlencode }}">
    <input type="hidden" name="email" value = "{{ user.email }}">
    <input type="hidden" name="password" value = "{{ request.form.get('password') }}">

    <label id="label-otp" for="otp-code" class="mt-3">Two-Factor Code</label>
    <p id="text-otp" class="text-small">Or 25-character recovery code
    <input class="form-control" id="otp-code" aria-labelledby="label-otp" aria-described-by="text-otp" type="text" name="otp_code" required="" placeholder="# # # # # #">

  </form>

  <button class="btn btn-primary w-100 mt-3 toast-form-submit" data-form="form-login">Continue</button>

</div>
{% endblock %}